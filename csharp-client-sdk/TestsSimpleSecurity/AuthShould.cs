
//------------------------------------------------------------------------------
// <auto-generated>
// This code was generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
//
// Changes to this file may cause incorrect behavior and will be lost when
// the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------
using Xunit;
using Openapi;
using Openapi.Models.Shared;
using Openapi.Models.Operations;
using System.Collections.Generic;
using System.Threading.Tasks;

public class AuthShould
{
    [Fact]
    public async Task TestGlobalSecurityFlattening()
    {
        CommonHelpers.RecordTest("auth-global-security-flattening");

        var sdk = new SDK(apiKeyAuth: "Bearer testToken");

        var res = await sdk.Auth.ApiKeyAuthGlobalAsync();

        Assert.NotNull(res);
        Assert.Equal(200, res.StatusCode);
        Assert.True(res.Token.Authenticated);
        Assert.Equal("testToken", res.Token.Token);
    }

    [Fact]
    public async Task TestGlobalSecurityFlatteningCallback()
    {
        CommonHelpers.RecordTest("auth-global-security-flattening-callback");

        var ex = Assert.Throws<System.Exception>(() => new SDK());
        Assert.Equal("apiKeyAuth and apiKeyAuthSource cannot both be null", ex.Message);

        var sdk = new SDK(apiKeyAuthSource: () => "Bearer testToken");

        var res = await sdk.Auth.ApiKeyAuthGlobalAsync();

        Assert.NotNull(res);
        Assert.Equal(200, res.StatusCode);
        Assert.True(res.Token.Authenticated);
        Assert.Equal("testToken", res.Token.Token);
    }
}
