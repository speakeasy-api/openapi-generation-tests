"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

import random
import string
import os
from openapi import SDK
from openapi.models.components import Security
from .common_helpers import record_test


def test_client_credentials_hook_successfully_authenticates():
    record_test("hooks-client-credentials-success")

    s = SDK(
        security=Security(
            client_id="speakeasy-sdks",
            client_secret="supersecret-" + rand_seq(10),
        )
    )
    assert s is not None

    res = s.authenticated_request(request=None)
    assert res is not None
    assert res.http_meta is not None
    assert res.http_meta.response is not None
    assert res.http_meta.response.status_code == 200

    res = s.authenticated_request(request=None)
    assert res is not None
    assert res.http_meta is not None
    assert res.http_meta.response is not None
    assert res.http_meta.response.status_code == 200

    os.environ["SPEAKEASY_CLIENT_ID"] = "speakeasy-sdks"
    os.environ["SPEAKEASY_CLIENT_SECRET"] = "supersecret-" + rand_seq(10)
    s2 = SDK()
    assert s2 is not None

    res2 = s2.authenticated_request(request=None)
    assert res2 is not None
    assert res2.http_meta is not None
    assert res2.http_meta.response is not None
    assert res2.http_meta.response.status_code == 200
    os.environ["SPEAKEASY_CLIENT_ID"] = ""
    os.environ["SPEAKEASY_CLIENT_SECRET"] = ""


def rand_seq(n) -> str:
    return "".join(random.choices(string.ascii_lowercase + string.digits, k=n))
