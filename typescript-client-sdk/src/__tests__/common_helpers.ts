/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as fs from "fs";

export function recordTest(id: string) {
  fs.appendFileSync("test-typescript-record.txt", id + "\n");
}

export async function consumeStream(
  readableStream: ReadableStream<Uint8Array>,
) {
  const reader = readableStream.getReader();

  const chunks = [];
  let totalLength = 0;

  // eslint-disable-next-line no-constant-condition
  while (true) {
    const { done, value } = await reader.read();
    if (done) break;

    chunks.push(value);
    totalLength += value.length;
  }

  const fullArray = new Uint8Array(totalLength);
  let position = 0;

  for (const chunk of chunks) {
    fullArray.set(chunk, position);
    position += chunk.length;
  }

  return fullArray;
}
