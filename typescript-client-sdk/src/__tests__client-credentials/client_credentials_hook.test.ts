/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { expect, test } from "vitest";

import { SDK } from "../index.js";
import { recordTest } from "./common_helpers.js";

test("test client credentials hook successfully authenticates", async () => {
  recordTest("hooks-client-credentials-success");

  const sdk = new SDK({
    security: {
      clientID: "speakeasy-sdks",
      clientSecret: "supersecret-" + randSeq(10),
    },
  });

  let res = await sdk.authenticatedRequest({});
  expect(res.httpMeta.response.status).toBe(200);

  res = await sdk.authenticatedRequest({});
  expect(res.httpMeta.response.status).toBe(200);
});

test("test client credentials hook successfully authenticates with alt token url", async () => {
  recordTest("hooks-client-credentials-success-alt-token-url");

  const sdk = new SDK({
    security: {
      clientID: "speakeasy-sdks",
      clientSecret: "supersecret-" + randSeq(10),
      tokenURL: "/clientcredentials/alt/token",
    },
  });

  let res = await sdk.authenticatedRequest({});
  expect(res.httpMeta.response.status).toBe(200);

  res = await sdk.authenticatedRequest({});
  expect(res.httpMeta.response.status).toBe(200);
});

function randSeq(length: number) {
  const chars = "abcdefghijklmnopqrstuvwxyz";
  let result = "";
  for (let i = 0; i < length; i++) {
    result += chars.charAt(Math.floor(Math.random() * chars.length));
  }

  return result;
}
