/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { afterEach, expect, test, vi } from "vitest";

import { SDK } from "../index.js";
import { Security } from "../sdk/models/shared/security.js";
import { recordTest } from "./common_helpers.js";
import { resetEnv } from "../lib/env.js";

afterEach(() => {
  resetEnv();
  vi.unstubAllEnvs();
});

test("function callbacks for oAuth support are invoked for global security", async () => {
  recordTest("auth-function-callbacks-oauth-global-security");

  const sdk = new SDK({
    security: async (): Promise<Security> => ({
      oauth2: "Bearer global",
    }),
  });

  const res = await sdk.auth.globalBearerAuth();

  expect(res.token?.token).toBe("global");
});
